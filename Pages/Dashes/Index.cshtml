@page
@using CodeMechanic.Types
@using evantage.Pages.Components
@using Hydro
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using CodeMechanic.Maths
@model evantage.Pages.Dashes.Index

@{
    var videos = @Model.Videos;
    var all_weeks = @Model.AllWeeks;
    var add_video = new YoutubeVideo();
    var add_earnings = new Earnings();
}

<section id="dashes">

    <div class="flex flex-col items-center justify-center">
        <div class="hero min-h-screen bg-base-200">
            <div class="hero-content flex-col lg:flex-row-reverse">
                <shadow shadow-type="double">
                    <h1 class="text-3xl">Welcome to Doordash!</h1>
                </shadow>
            </div>
        </div>

        <div class="h-20">

            <shadow shadow-type="distant">
                <h2 class="text-2xl">Weekly Earnings</h2>
            </shadow>
        </div>
        <div id="earnings_grid" class="grid md:grid-cols-2 sm:grid-cols-1">

            @foreach ((var week,int index) in all_weeks.WithIndex())
            {
                var previous_week = index > 0 ? all_weeks[index - 1] : null;
                <bento-card>
                    <slot name="title">Week @(@index + 1)</slot>

                    <div class="stats stats-vertical shadow">

                        <div class="stat">
                            <div class="stat-title"> @(nameof(week.average_gas_tank_cost)):</div>
                            <div class="stat-value">@week.average_gas_tank_cost</div>

                            @if (previous_week != null)
                            {
                                <div class="stat-desc text-info">
                                    @(@previous_week.average_gas_tank_cost
                                        .PercentChanged(week.average_gas_tank_cost)
                                        .RoundTo(2))% compared to last week
                                </div>
                            }
                        </div>

                        <div class="stat">
                            <div class="stat-title"> @(nameof(week.estimated_earnings_for_week)):</div>
                            <div class="stat-value">$@week.estimated_earnings_for_week</div>

                            @if (previous_week != null)
                            {
                                <div class="stat-desc text-info">
                                    @(@previous_week.estimated_earnings_for_week
                                        .PercentChanged(week.estimated_earnings_for_week)
                                        .RoundTo(2))% compared to last week
                                </div>
                            }
                        </div>

                        <div class="stat">
                            <div class="stat-title"> @(nameof(week.gas_savings_for_week)):</div>
                            <div class="stat-value">$@week.gas_savings_for_week</div>

                            @if (previous_week != null)
                            {
                                <div class="stat-desc text-info">
                                    @(@previous_week.gas_savings_for_week
                                        .PercentChanged(week.gas_savings_for_week)
                                        .RoundTo(2))% compared to last week
                                </div>
                            }
                        </div>
                    </div>
                    <ul>
                        @* <hydro-li> *@
                        @*     @(nameof(week.average_gas_tank_cost)): @week.average_gas_tank_cost *@
                        @* </hydro-li> *@
                    </ul>
                </bento-card>
            }


            <bento-card>
                <slot name="title">Add Earnings</slot>

                <form>
                    <input class="bg-ghost" placeholder="@nameof(add_earnings.phone_app)"/>
                    <input class="bg-ghost" placeholder="@nameof(add_earnings.fillups_for_the_week)"/>
                    <input class="bg-ghost" placeholder="@nameof(add_earnings.days_run_this_week)"/>

                    <button type="submit">Send it</button>
                </form>
            </bento-card>
        </div>

        <div class="h-20">

            <shadow shadow-type="distant">
                <h2 class="text-2xl">Helpful Videos</h2>
            </shadow>

        </div>
        <div id="videos_grid" class="grid md:grid-cols-2 sm:grid-cols-1">

            @foreach (var video in videos)
            {
                <bento-card>

                    <slot name="image">
                        @* <iframe src="@video.Url"></iframe> *@
                    </slot>
                    <slot name="title">
                        @video.Title
                    </slot>
                    <ul class="list-disc space-y-2">

                        @foreach (var note in video.Notes)
                        {
                            <hydro-li>@note</hydro-li>
                        }
                    </ul>

                    <slot name="buttons">
                        <p class="badge badge-sm badge-accent">@video.Status.Name</p>
                    </slot>
                    @* <h1 x-text="message" class="text-5xl font-bold"></h1> *@
                    <!-- <p  class="py-6">Provident cupiditate voluptatem et in. Quaerat fugiat ut assumenda excepturi exercitationem quasi. In deleniti eaque aut repudiandae et a id nisi.</p>
            
                    <a href="https://www.youtube.com/shorts/jOH3r2X_k7U">
                        <button class="btn btn-primary">ðŸ¥” Go</button>
                    </a> -->
                </bento-card>
            }

            <bento-card>
                <slot name="title">Add Video</slot>

                <form>
                    <input class="bg-ghost" placeholder="@nameof(add_video.Url)"/>
                    <input class="bg-ghost" placeholder="@nameof(add_video.Title)"/>
                    <input class="bg-ghost" placeholder="@nameof(add_video.Notes)"/>
                    <button type="submit">Send it</button>
                </form>
            </bento-card>
        </div>

    </div>

</section>